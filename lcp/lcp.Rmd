---
title: Deep learning analysis of lung nodules decreases false positive rate in the National Lung Screening Trial
output:
  word_document:
    reference_docx: style.docx
bibliography: bibliography.bib
csl: journal-of-the-national-cancer-institute.csl
---


Introduction {#introduction .unnumbered}
========================================

We used an AI developed for discrimination of malignant and benign
nodules, to see whether it could improve a clinical model for the
prediction of a screening patient's likelihood of developing cancer over
the upcoming year. The existing model used a number of features
extracted from the metadata of the US National Lung Screening Trial
(NLST) to produce a likelihood score, given a screening output in year
*y*, of developing cancer before the corresponding screening image taken
at year *(y+1)*. These features included both patient clinical data
(age, smoking history etc), and quantities extracted from a radiological
read of the screening CT, such as maximal nodule size, the existence of
any GGO nodules on the CT, and presence of emphysema within the patient.

Methods {#methods .unnumbered}
==============================

The chest CT scans used in this study were taken from the all three
years of the NLST from both the LSS branch and the ACRIN branch; 8416
patients were used for training, 480 for validation, and 2016 for
testing. Each CT scan was labeled by radiologists at the site of the
screening for lung CT abnormalities.

A re-curated version of the NLST dataset CTs and metadata was used for
this study. Each CT listed as containing at least one nodule was
reviewed by a medical doctor or medical student, under expert
supervision from University of Oxford Radiologists, and metadata records
of the CT findings were reviewed and extended. In particular, the size,
extent, location, margins and attenuation of each nodule were reviewed
by the same small team of individuals, and the exact 3D location of each
nodule was identified and recorded. Additional nodules not listed in the

NLST metadata were also added as long as they were not fully calcified
(since fully calcified nodules were not considered "positive findings"
in the original NLST data). As well as reviewing all CTs on which one or
more nodules was recorded, the team also reviewed all CTs of patients
recorded as having developed lung cancer, and again fully reviewed and
extended their mark-up and metadata. Patients who never had any reported
nodules and also never had lung cancer were not considered or marked up.

An AI called the LCP-CNN (Lung Cancer Prediction Convolutional Neural Network)
was trained on this augmented NLST set in an 8-fold cross-validated way using
Tensorflow @keras15. The AI training is outside the scope of this publication,
but for reference, the training used class balancing, and also extensive
pre-training on hundreds of thousands of non-NLST images in order to achieve
strong performance both on the testing folds of the cross-validation, and also
on several independent external datasets.

The AI was trained for the task of malignant vs benign classification,
and produces a score where 0 indicates benignity, and 100 indicates
malignancy.

The set of features extracted from the NLST metadata and the re-curated
CT information represents the full space of information available to our
new model.

\[Table of each feature under consideration for the screening models.
Detail which features are derived from where. LP or ND will use this
list to produce the up-to-date release of Optellum's nodule data and
metadata for use in this project\].

The new model we are fitting is an extension of \<background description
of Hilary's work\>. The particular form of the model being fitted is
\<equations\>.

Two versions of the model were fitted using the feature set described
above. In the first, the maximum LCP score for a given CT was *not*
available as a feature, and in the second, it was available for
selection. In both cases, feature selection was done using \[Bayes
Information Criterion or Lasso\].


The two (or four?) models were then compared according to \<TBD the
necessary but sufficient statistical tests\>, showing that in both cases
the addition of the LCP-CNN gave a better fit to data.

Results {#results .unnumbered}
==============================

We should defer writing up any results until we've reached consensus
with everything above.
most of this is required during training and not during deployment.

Discussion {#discussion .unnumbered}
==========

The results presented here show that 3D CNN-based approaches are a promising
direction of research for computer-aided prediction of a future cancer
diagnosis. As well as just diagnosing cancer, neural networks could identify
multiple CT-diagnosed diseases to identify risk factors for lung cancer, or
even identify lung cancer risk directly.
Furthermore, the neural network may be useful as significantly more robust than the density mask approach, even with a
very basic network.

Tables {#tables .unnumbered}
======

Table 1: Model Table

Table 2: Variable Table

Figures
=======

Figure 1: Lorenz curve


Other Figures?
Representative images of physician-annotated emphysematous and non-emphysematous CT scans (familiar for radiologists)
Representative images of model-predicted emphysematous and non-emphysematous CT scans (familiar for radiologists)

Network architecture and learning curves
Network architecture: `keras.utils.plot_model()` (helpful for those not familiar with deep learning)
Learning curves: `training_graph.py` (helpful for those not familiar with deep learning)

Neural network performance for predicting emphysema
Confusion matrix - 2 x 2 table of actual versus predicted labels to show performance of model for predicting emphysema
Receiver operating characteristic (ROC) curve to show performance of model for predicting emphysema


Markov model performance for predicting cancer risk
Confusion matrix - 2 x 2 table of actual versus predicted labels to show performance of Markov model
Receiver operating characteristic (ROC) curve to show performance of Markov model

Comparison of binary classifier network versus image features network
Confusion matrix - 2 x 2 table of actual versus predicted labels to show performance of Markov model
Receiver operating characteristic (ROC) curve to show performance of Markov model
